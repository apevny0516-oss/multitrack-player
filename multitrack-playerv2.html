<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Multitrack Player (Dynamic Title)</title>
<style>
body { font-family: sans-serif; background: #f5f5f5; padding: 1rem; }
.track { background: white; padding: 1rem; margin-bottom: 0.5rem; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
button { cursor: pointer; border: 1px solid #ccc; border-radius: 4px; padding: 0.25rem 0.5rem; font-size: 1rem; }
button.active { background-color: #007bff; color: white; border-color: #007bff; }
.progress-container { margin-top: 1rem; position: relative; }
.time { font-size: 0.8rem; display: flex; justify-content: space-between; color: #555; }
.loop-highlight { position: absolute; top: 50%; height: 6px; background: rgba(0,123,255,0.3); border-radius: 3px; transform: translateY(-50%); pointer-events: none; }
#bookmarksPanel h3 { margin-bottom: 0.75rem; }
#bookmarksPanel button {
font-size: 1.2rem;
font-weight: bold;
margin-bottom: 0.6rem;
padding: 0.5rem 0.75rem;
display: block;
width: 100%;
text-align: left;
}
.controls {
display: flex;
flex-wrap: wrap;
gap: 0.5rem;
}
.volume-line {
flex-basis: 100%;
display: flex;
flex-direction: row;
align-items: center;
gap: 0.5rem;
}
@media (max-width: 600px) {
.volume-line {
flex-direction: column;
align-items: flex-start;
}
}
</style>
</head>
<body>
<h2 id="songTitle">Multitrack Player</h2>
<div class="controls">
<button id="play" title="Play">▶️</button>
<button id="pause" title="Pause">⏸️</button>
<button id="stop" title="Stop">⏹️</button>
<button id="loop">Loop Start</button>
<div class="volume-line">
<label for="masterVol">Master Volume</label>
<input id="masterVol" type="range" min="0" max="1" step="0.01" value="1">
</div>
</div>
<div id="progressContainer" class="progress-container"></div>
<div id="tracks"></div>
<div id="bookmarksPanel" style="margin-top:1rem;"></div>
<script>
const params = new URLSearchParams(window.location.search);
const stems = [];
let markersFile = null;
for (const [key, value] of params.entries()) {
  if (['markers', 'lyrics', 'text'].includes(key.toLowerCase())) {
    markersFile = value;
  } else {
    stems.push({ name: key, url: value });
  }
}
function extractSongInfo() {
  if (stems.length === 0) return;
  const sample = decodeURIComponent(stems[0].url);
  const match = sample.match(/([^\/]+)\.[^\/]+$/);
  if (!match) return;
  const filename = match[1].replace(/_/g, ' ');
  const cleaned = filename.replace(/\b(guitar|bass|drums|vocals|metronome|mix|stem|track)\b/gi, '').trim();
  const parts = cleaned.split('-').map(s => s.trim());
  let displayTitle = '';
  if (parts.length >= 2) {
    displayTitle = `${parts[0]} – ${parts.slice(1).join('-')}`;
  } else {
    displayTitle = cleaned;
  }
  document.getElementById('songTitle').textContent = displayTitle;
}
extractSongInfo();
</script>
</body>
</html>
